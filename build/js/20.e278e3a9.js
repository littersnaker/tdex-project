webpackJsonp([20],{112:function(e,t,a){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=a(0),c=a.n(l),i=a(24),o=a(7),u=a(2),d=a(9),h=a(25),m=a(27),f=a(18),p=a(15),g=a(26),v=a(147),w=a(5),E=a(79),y=a(130),N=a(16),b=a(138),A=(a.n(b),function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}()),k=function(e){function t(e){r(this,t);var a=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.query=0,a.Products=[],a.safeBind=!1,a.state={Codes:"",balance:null,addressList:[],defaultAddress:"",FeeNum:0,withCounts:"",showPro:!1,showAdr:!1,newAdr:!1,errType:0,errTxt:"",showWd:!0,refreshLog:!1,change:"",showLog:!1},a}return s(t,e),A(t,[{key:"queryHandle",value:function(){var e=this.props.location.query,t=e.currency;if(this.query==t)return!1;this.query=t}},{key:"componentDidMount",value:function(){this.refs.selectAdr.focus()}},{key:"componentWillMount",value:function(){this.queryHandle(),this.loadCodesList();var e=f.a.getUserInfo();(e.GgAuth||e.Mobile)&&(this.safeBind=!0)}},{key:"loadCodesList",value:function(){var e=m.a.getProductCoins(),t=this;e?this.saveProducts(e):m.a.loadProductCoins(null,function(e){e&&t.saveProducts(e.List)},this)}},{key:"saveProducts",value:function(e){if(this.Products=m.a.filterProducts(e,2),this.Products&&this.Products.length){var t=this.Products[0];this.query?t=this.setProduct(this.query):this.setProduct(t.Id),this.getWalletBalance(t.Id)}}},{key:"setProduct",value:function(e){var t={};for(var a in this.Products){if(e==this.Products[a].Id){t=this.Products[a];break}}return this.setState({Codes:t}),t}},{key:"getWalletBalance",value:function(e,t){var a=this;d.a.httpRequest("wallet/balance",{Currency:Number(e),Type:Number(N.a.WALLET.TYPE.SPOT)},function(e){if(0==e.Status){var r=e.Data,n={balance:r,showPro:!1};t&&(n.refreshLog=!a.state.refreshLog),a.setState(n),a.loadWalletAddress(r.Currency)}else a.setState({balance:null})},this)}},{key:"loadWalletAddress",value:function(e){var t=this;d.a.httpRequest("wallet/address",{Type:2,Currency:Number(e)},function(e){if(0==e.Status){var a=e.Data.List,r=a||[],n="";a&&a.length&&(n=a[0].Address),t.setState({addressList:r,defaultAddress:n})}},this)}},{key:"deleteAddress",value:function(e,t,a){a=a||window.event,a.stopPropagation();var r=this;g.a.open(c.a.createElement(v.a,{title:u.a.lang("ManageWalletAdd.delete"),content:u.a.lang("ManageWalletAdd.delete_info"),callback:function(){return r.removeAddress(e,t)}}),"alert_panel")}},{key:"removeAddress",value:function(e,t){var a=this.state.addressList,r=this;d.a.httpRequest("wallet/address",{Id:e},function(e){0==e.Status&&(a.splice(t,1),r.setState({addressList:a}))},this,"delete")}},{key:"resetState",value:function(){var e={showAdr:!1,newAdr:!1,errType:0,errTxt:"",FeeNum:0,withCounts:""};this.refs.selectAdr.value="",this.setState(e)}},{key:"changeProduct",value:function(e){if(e==this.state.Codes.Id)return!1;this.setProduct(e),this.getWalletBalance(e,"refreshLog"),this.resetState(),o.a.replace({pathname:"/withdrawals",query:{currency:e}})}},{key:"toggleProduct",value:function(e){e.stopPropagation(),this.setState({showPro:!this.state.showPro})}},{key:"toggleAddress",value:function(e){e.stopPropagation(),this.setState({showAdr:!this.state.showAdr})}},{key:"closeProduct",value:function(e){e.stopPropagation();var t=null;this.state.showPro&&(t=t||{},t.showPro=!1),this.state.showAdr&&(t=t||{},t.showAdr=!1),t&&this.setState(t)}},{key:"changeAddress",value:function(e){e.preventDefault(),e.stopPropagation();var t=e.target.value;this.setState({defaultAddress:t})}},{key:"addNewAddress",value:function(){if(this.state.newAdr)return void this.setState({showAdr:!this.state.showAdr});this.setState({newAdr:!0,showAdr:!this.state.showAdr,errType:0,errTxt:""}),this.refs.selectAdr.value="",this.refs.selectAdr.placeholder=u.a.lang("Withdrawals.tip.addAddress");var e=this;this.nextTick(function(){e.refs.adrDes.focus()})}},{key:"selectAddress",value:function(e){this.setState({newAdr:!1,showAdr:!this.state.showAdr,errType:0,errTxt:"",defaultAddress:e})}},{key:"nextTick",value:function(e){setTimeout(function(){if(e)return e()},300)}},{key:"checkInputCount",value:function(e,t){Valiate.maxFloat(t,2);return!0}},{key:"setFeeNum",value:function(e){var t=this.state,a=t.Codes,r=(t.balance,0);if(a){var n=this.refs.withNum.value;"Value"==a.FeeType?r=a.Fee:isNaN(n)||(r=Number(p.a.accMul(a.Fee,Number(n))));var s={FeeNum:r,withCounts:n},l=this.checkMoney(r);Object.assign(s,l),this.setState(s)}}},{key:"setMaxWith",value:function(e,t){t.stopPropagation(),this.refs.withNum.value=Number(e),this.setFeeNum()}},{key:"resetError",value:function(){this.setState({errType:0,errTxt:""})}},{key:"checkMoney",value:function(e){var t=this.state,a=t.Codes,r=t.balance,n=t.errType,s=this.walletCounts(r),l=this.refs.withNum.value,c={},i=Number(l);return""==l?(c.errType=4,c.errTxt=u.a.lang("form.error.empty")):isNaN(i)?(c.errType=4,c.errTxt=u.a.lang("Withdrawals.correct_input"),c.withCounts=""):i<a.MinCash?(c.errType=4,c.errTxt=u.a.lang("Withdrawals.error.lessMin")+a.MinCash):/^(-?\d+)(\.\d{1,4})?$/.test(i)?s.canUse<i?(c.errType=4,c.errTxt=u.a.lang("Withdrawals.error.maxWith")):e&&s.canUse<e?(c.errType=4,c.errTxt=u.a.lang("Withdrawals.free_less")):4==n&&this.resetError():(c.errType=4,c.errTxt=u.a.lang("Withdrawals.error.maxFloat",4)),c}},{key:"checkDataLegal",value:function(e,t){var a=e||window.event;a&&a.stopPropagation();var r=this.state,n=r.newAdr,s=r.errType,l=0,c="";if(t){var i=this.checkMoney();i.errType&&(l=4,c=i.errTxt)}if(n){var o=this.refs.adrDes.value.replace(/\s+/g,"");if(this.refs.adrNew.value.replace(/\s+/g,"")){if(4!=l)if(o){var d=/^[A-Za-z0-9]{3,10}$/.test(o);d||(l=2,c=u.a.lang("Withdrawals.error.label","3-10"))}else l=8,c=u.a.lang("Withdrawals.remark_note")}else l=3,c=u.a.lang("form.error.empty")}else{this.refs.selectAdr.value.replace(/\s+/g,"")||(l=1,c=u.a.lang("form.error.empty"))}if(l)return this.setState({errType:l,errTxt:c}),8!=l&&l;s&&this.resetError()}},{key:"handleSubmit",value:function(e){return e.stopPropagation(),e.preventDefault(),this.safeBind?this.state.Codes?!this.checkDataLegal(!1,!0)&&void this.popVerify():(Object(w.g)(u.a.lang("common.not_open"),!0),!1):(Object(w.g)(u.a.lang("Withdrawals.119"),!0),!1)}},{key:"popVerify",value:function(){var e=this;g.a.open(c.a.createElement(E.default,{path:"disTips",verify:"normal",onChange:function(t){return e.popCallback(t)},datafor:"withdraw"}),"simple_lang",!0)}},{key:"popCallback",value:function(e){if("close"==e)return g.a.close(),!1;this.walletWithdraw(e)}},{key:"walletWithdraw",value:function(e){var t=this.state,a=t.Codes,r=t.newAdr,n=t.refreshLog;e.Currency=a.Id,e.Target=a.Id,r?(e.Label=this.refs.adrDes.value.replace(/\s+/g,""),e.Address=this.refs.adrNew.value.replace(/\s+/g,"")):e.Address=this.refs.selectAdr.value.replace(/\s+/g,""),e.Amount=Number(this.refs.withNum.value);var s=this;d.a.httpRequest("wallet/withdraw",e,function(e){if(0==e.Status){g.a.close();var t=e.Data;s.setState({balance:t,refreshLog:!n}),Object(w.g)(u.a.lang("Withdrawals.success"))}},this)}},{key:"walletCounts",value:function(e){var t=0,a=0,r=0;return e&&(a=Number(p.a.accAdd(e.Lock,p.a.accAdd(p.a.accAdd(e.Transfer,e.Deposit),e.Withdraw))),t=Number(p.a.accAdd(a,p.a.accSubtr(e.Quantity,e.Unconfirm))),r=t>0?Number(e.Quantity):0),{Counts:t,Freeze:a,canUse:r}}},{key:"getActual",value:function(e,t){var a=this.refs.withNum;if(!a)return!1;var r=Number(a.value),n=0;if(!isNaN(r)){if(r>e)return 0;n=Number(p.a.accSubtr(r,t))}return n<0?"0.000":n}},{key:"showLog",value:function(e){this.setState({showLog:e})}},{key:"render",value:function(){var e=this,t=this.state,a=t.addressList,r=t.balance,n=t.Codes,s=t.defaultAddress,l=t.withCounts,i=t.FeeNum,o=t.showPro,d=t.showAdr,m=t.newAdr,f=t.errType,g=t.errTxt,v=t.refreshLog,w=t.showLog,E="0.0000",y="0.0000",N="0.0000",b="";if(r){var A=this.walletCounts(r);E=p.a.format(A.Counts,4),y=p.a.format(A.Freeze,4),N=p.a.format(A.canUse,4).toString()}n&&(b=n.Code);var k=this.getActual(N,i);return c.a.createElement("div",{className:"inside-page-web",onClick:function(t){return e.closeProduct(t)}},c.a.createElement("div",{className:"inside-web-part"},c.a.createElement("div",{className:"withdrawal"},c.a.createElement("div",{className:"w-head-top m-head-top"},c.a.createElement("h3",{onClick:function(){return e.showLog(!1)},className:"fl "+(w?"m-under-l":"")},u.a.lang("account.1_3")),c.a.createElement("h3",{onClick:function(){return e.showLog(!0)},className:"pc-hide fr "+(w?"":"m-under-l")},u.a.lang("Recharge.log"))),c.a.createElement("div",{className:0==w?"currency_left":"currency_left m-hide"},c.a.createElement("div",{className:"select",onClick:function(t){return e.toggleProduct(t)}},c.a.createElement("div",{className:"currency_pic"}),c.a.createElement("div",{className:"currency_text"},c.a.createElement("h4",null,b)),c.a.createElement("div",{className:"triangle"},c.a.createElement("i",{className:0==o?"iconfont icon-dropDown c-8":"iconfont icon-dropUp c-8"}))),o&&c.a.createElement("div",{className:"select_option"},c.a.createElement("ul",null,c.a.createElement("li",{className:"h-50 tc hide"},c.a.createElement("div",{className:"select_option_ipt"},c.a.createElement("input",{type:"text",name:"",id:"",value:"",placeholder:""}))),this.Products&&this.Products.map(function(t,a){return c.a.createElement("li",{key:a,onClick:function(){return e.changeProduct(t.Id)}},c.a.createElement("div",{className:"currency_pic"}),c.a.createElement("div",{className:"currency_text"},c.a.createElement("h4",null,t.Code)))}),!this.Products.length&&c.a.createElement("li",{className:"tc"},c.a.createElement("div",{className:"currency_text c-8"},c.a.createElement("h4",null,u.a.lang("common.not_open")))))),c.a.createElement("div",{className:"calculate"},c.a.createElement("ul",null,c.a.createElement("li",null,c.a.createElement("p",null,u.a.lang("recharge.total"))),c.a.createElement("li",null,c.a.createElement("p",null,u.a.lang("Asset.100"))),c.a.createElement("li",null,c.a.createElement("p",null,u.a.lang("recharge.canUse")))),c.a.createElement("ul",null,c.a.createElement("li",{className:"calculate_text"},c.a.createElement("p",null,E+" "+b)),c.a.createElement("li",{className:"calculate_text"},c.a.createElement("p",null,y+" "+b)),c.a.createElement("li",{className:"calculate_text"},c.a.createElement("p",null,N+" "+b)))),c.a.createElement("form",{className:"Withdrawal_form",onSubmit:function(t){e.handleSubmit(t)},autoComplete:"off"},c.a.createElement("h4",null,u.a.lang("Recharge.note")),c.a.createElement("ul",null,c.a.createElement("li",null,c.a.createElement("p",null,u.a.lang("Withdrawals.with_min"),n.MinCash," ",n.Code)),c.a.createElement("li",null,c.a.createElement("p",null,u.a.lang("ManageWalletAdd.105")))),c.a.createElement("div",{className:"input_box mt-10"},c.a.createElement("h5",null,n.Code," ",u.a.lang("Withdrawals.with_address")),c.a.createElement("div",{className:"address pos-r f-clear"},c.a.createElement("div",{onClick:function(t){return e.toggleAddress(t)}},c.a.createElement("div",{className:"ipt ipt-box "+(1==f?"bd-err":m?"ipt-disable":"")},c.a.createElement("input",{type:"text",ref:"selectAdr",value:s,onChange:function(t){e.changeAddress(t)}})),c.a.createElement("div",{className:"btn ipt-box"},c.a.createElement("i",{className:0==d?"iconfont icon-dropDown c-8":"iconfont icon-dropUp c-8"}))),d&&c.a.createElement("div",{className:"address-box"},c.a.createElement("dl",{className:"address-list"},c.a.createElement("dt",{onClick:function(){return e.addNewAddress()}},c.a.createElement("i",{className:"iconfont icon-add-bg fem125 ver-md"}),c.a.createElement("span",{className:"pdl-5"},u.a.lang("Withdrawals.new_address"))),a&&a.map(function(t,a){return c.a.createElement("dd",{key:a,onClick:function(){return e.selectAddress(t.Address)}},c.a.createElement("span",{className:"pdr-20 dis-inb w-60"},t.Label),c.a.createElement("span",null,t.Address),c.a.createElement("i",{className:"iconfont icon-close close-red",onClick:function(r){return e.deleteAddress(t.Id,a,r)}}))}))))),m&&c.a.createElement("div",{className:"mt-10 addressAdd"},c.a.createElement("i",{className:"iconfont icon-question pdr-5",title:u.a.lang("Withdrawals.labelTip")}),c.a.createElement("input",{type:"text",ref:"adrDes",className:"w-125 "+(2==f?"bd-err":8==f?"bd-warn":""),placeholder:u.a.lang("Withdrawals.label")}),c.a.createElement("span",{className:"pd05 gray"},"\u2014"),c.a.createElement("input",{type:"text",ref:"adrNew",className:3==f?"w-330 bd-err":"w-330",placeholder:u.a.lang("Withdrawals.address")})),f<4&&g&&c.a.createElement("div",{className:"fem75 mt-5 red2 pdl-20"},g),8==f&&g&&c.a.createElement("div",{className:"fem75 mt-5 warn pdl-20"},g),c.a.createElement("div",{className:"input_box2",onClick:function(t){return e.checkDataLegal(t)}},c.a.createElement("div",{className:"f-clear"},c.a.createElement("h5",null,u.a.lang("Withdrawals.amount")),c.a.createElement("h5",{className:"hide"},u.a.lang("withdrawal.quota","24h")," ",c.a.createElement("span",null,"--"))),c.a.createElement("div",{className:"address f-clear"},c.a.createElement("div",{className:"ipt ipt-box pos-r "+(4==f?"bd-err":"")},c.a.createElement("input",{type:"text",ref:"withNum",onChange:function(){return e.setFeeNum(N)},value:l,maxLength:"15"}),c.a.createElement("div",{className:"withUse",onClick:function(t){return e.setMaxWith(N,t)}},u.a.lang("Withdrawals.103"),c.a.createElement("span",null,N))),c.a.createElement("div",{className:"ipt-box unit-bdl-none"},b)),4==f&&g&&c.a.createElement("div",{className:"red2 fem75 mt-5"},g)),c.a.createElement("div",{className:"input_box3"},c.a.createElement("h5",null,u.a.lang("Withdrawals.fee"),c.a.createElement("span",null,i)),c.a.createElement("h5",null,u.a.lang("Withdrawals.109"),c.a.createElement("span",null,k)),c.a.createElement("button",{type:"submit",className:"btn "+(this.safeBind&&E>0?"":"btnDis")},u.a.lang("common.submit"))),!this.safeBind&&c.a.createElement("div",{className:"fem75 mt-15"},c.a.createElement(h.Link,{className:"green4 fs14 cursor pdl-20 warn",to:"/personal"},u.a.lang("Withdrawals.119")))),c.a.createElement("div",{className:"attention"},c.a.createElement("h4",null,u.a.lang("Recharge.tips")),c.a.createElement("ul",null,c.a.createElement("li",null,c.a.createElement("p",null,u.a.lang("Withdrawals.tips_1"," 9:00 "," 0:00 ")),c.a.createElement("p",{dangerouslySetInnerHTML:{__html:u.a.lang("Recharge.tips_2")}}))))),c.a.createElement("div",{className:1==!w?"m-hide":null},c.a.createElement(P,{product:n,refresh:v})))))}}]),t}(i.a);t.default=k;var P=function(e){function t(e){r(this,t);var a=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.product=null,a.refresh=!1,a.state={curPage:1,historyList:{List:[],PageSize:10}},a}return s(t,e),A(t,[{key:"componentDidMount",value:function(){}},{key:"getHistory",value:function(e){var t=e||this.state.curPage,a=this.product.Id;if(!a)return!1;var r=this;d.a.httpRequest("wallet/orders",{Type:2,Currency:Number(a),Page:t,PageSize:10},function(e){if(0==e.Status){var t=e.Data;r.setState({historyList:t,curPage:t.Page})}},this)}},{key:"componentWillReceiveProps",value:function(e){var t=e.refresh;this.product||(this.product=e.product,this.getHistory()),this.refresh!=t&&(this.product=e.product,this.refresh=t,this.getHistory())}},{key:"turnPage",value:function(e){this.getHistory(e)}},{key:"render",value:function(){var e=this.state.historyList,t=this.props.product,a=this;return c.a.createElement("div",{className:"record_right pos-r"},c.a.createElement("div",{className:"historical"},c.a.createElement("h4",null,u.a.lang("Recharge.log"))),c.a.createElement("div",{className:"trade-order-log"},c.a.createElement("dl",{className:"log-title recommend-new f-clear"},c.a.createElement("dd",null,u.a.lang("accountSafe.1_102")),c.a.createElement("dd",null,u.a.lang("Asset.105")),c.a.createElement("dd",null,u.a.lang("tradeHistory.1_9")),c.a.createElement("dd",{className:"wp-33 m-w-60"},u.a.lang("Withdrawals.address")),c.a.createElement("dd",null,u.a.lang("recharge.1_23"))),c.a.createElement("div",{className:"log-contain log-list"},!e&&!e.length&&c.a.createElement("p",{className:"mt-30 tc"},u.a.lang("bank.1_27")),e.hasOwnProperty("Total")&&e.Total>0&&e.List.map(function(e,a){return c.a.createElement("dl",{className:"recommend-new f-clear",key:a},c.a.createElement("dd",null,e.CreateTime.substring(0,16)),c.a.createElement("dd",null,t.Code),c.a.createElement("dd",null,e.Amount),c.a.createElement("dd",{className:"wp-33"},c.a.createElement("p",null,e.Address)),c.a.createElement("dd",null,u.a.lang("EXCHANGE.STATUS."+e.Status)))}),e.hasOwnProperty("PageCount")&&e.PageCount>1&&c.a.createElement(y.a,{className:"mt-10",data:e,onChange:this.turnPage.bind(a)}))))}}]),t}(i.a)}});