webpackJsonp([28],{98:function(t,e,a){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}function l(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var r=a(0),o=a.n(r),s=a(24),u=a(2),c=a(130),d=a(28),m=a.n(d),g=a(231),h=a(186),p=(a.n(h),a(6)),f=a(9),E=(a(140),a(12)),b=a(7),y=(a(3),a(149)),D=a.n(y),v=(a(5),function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}()),T=function t(e,a,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,a);if(void 0===i){var l=Object.getPrototypeOf(e);return null===l?void 0:t(l,a,n)}if("value"in i)return i.value;var r=i.get;if(void 0!==r)return r.call(n)},B=function(t){function e(t){n(this,e);var a=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return a.state={tab:0,platformInfo:{totalTD:0,bonusToday:0,currentTD:0,bonusTotal:0,currentCycle:0,totalCost:0,pay:0},userInfo:{totalTD:0,totalBTC:0,totalCost:0,currentCost:0,validTD:0,validBTC:0,currentTD:0,currentBTC:0,pay:0},platformList:[],userList:[],platformCount:{countOutputValue:0,countOutputTotal:0,countExchangeValue:0,countExchangeTotal:0},platformDetail:{total:0,page:1,count:0},userDetail:{total:0,page:1,count:0},userCount:{countOutputValue:0,countOutputTotal:0,countExchangeValue:0,countExchangeTotal:0},oldPlatformList:null,oldUserList:null,oldPlatformInfo:null,oldUserInfo:null,tdPrice:0,startDate:m()().subtract(24,"hours"),endDate:m()(),isNoData:!1,isLogin:E.a.checkUserAuth(),startTime:parseInt(new Date(m()().subtract(24,"hours").format("YYYY-MM-DD")).getTime()/1e3),endTime:parseInt(Date.now()/1e3),action:0,tableTitle:[3,4,5,6,7]},a.updateData=null,a.heartbeat=6e4,a}return l(e,t),v(e,[{key:"componentDidMount",value:function(){var t=this;D.a.rebuild(),this.fetchPlatformMining().then(function(){t.fetchPlatformDetail(),t.state.isLogin&&(t.fetchUserMining(),t.fetchUserDetail())}),this.updateData=setInterval(function(){t.fetchPlatformMining()},this.heartbeat),window.addEventListener("resize",this.onResize.bind(this))}},{key:"componentWillUnmount",value:function(){this.updateData&&(clearInterval(this.updateData),this.updateData=null),window.removeEventListener("resize",this.onResize),T(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"componentWillUnmount",this).call(this)}},{key:"onResize",value:function(){Object(p.h)()&&b.a.push("/minetrade")}},{key:"fetchPlatformMining",value:function(){var t=this;return new Promise(function(e){f.a.httpRequest("mining/dashboard",null,function(a){if(!a.Status){var n=a.Data;t.setPlatformInfo(n),t.setState({oldPlatformInfo:n}),e(n)}},t)})}},{key:"fetchUserMining",value:function(){var t=this;f.a.httpRequest("mining/userMining",null,function(e){if(!e.Status){var a=e.Data;t.setUserInfo(a),t.setState({oldUserInfo:a})}},this)}},{key:"setPlatformInfo",value:function(t,e){var a=t.Mining&&t.Mining.Price?t.Mining.Price:0,n=t.Mining&&t.Mining.Total?t.Mining.Total:0,i=t.Mining&&t.Mining.Coming?t.Mining.Coming:0,l=t.Mining&&t.Mining.Period?t.Mining.Period:0,r=t.Mining&&t.Mining.Commission?t.Mining.Commission:0,o=t.Bonus&&t.Bonus.Today?t.Bonus.Today:0,s=t.Bonus&&t.Bonus.Total?t.Bonus.Total:0,u=t.Mining&&t.Mining.Pay?t.Mining.Pay:0;this.setState({platformInfo:{totalTD:this.thousandBitSeparator(Number(n).toFixed(4)),bonusTotal:this.thousandBitSeparator(Number(s).toFixed(8)),currentTD:this.thousandBitSeparator(Number(i).toFixed(4)),bonusToday:this.thousandBitSeparator(Number(o).toFixed(8)),currentCycle:l,totalCost:this.thousandBitSeparator(Number(r).toFixed(8)),TDPrice:this.thousandBitSeparator(Number(a).toFixed(8)),pay:this.thousandBitSeparator(Number(u).toFixed(4))},tdPrice:Number(a).toFixed(8)})}},{key:"setUserInfo",value:function(t,e){var a=t.Mining?t.Mining:{},n=a.History&&a.History.Total?a.History.Total:0,i=t.Bonus&&t.Bonus.Total?t.Bonus.Total:0,l=t.Bonus&&t.Bonus.Today?t.Bonus.Today:0,r=a.History&&a.History.Left?a.History.Left:0,o=a.History&&a.History.Period?a.History.Period:0,s=a.History&&a.History.Pay?a.History.Pay:0,u=e||this.state.tdPrice,c=a.Coming&&a.Coming.Total?a.Coming.Total:0;this.setState({userInfo:{totalTD:this.thousandBitSeparator(Number(n).toFixed(4)),totalBTC:this.thousandBitSeparator(Number(n*u).toFixed(8)),totalCost:this.thousandBitSeparator(Number(i).toFixed(8)),currentCost:this.thousandBitSeparator(Number(l).toFixed(8)),validTD:this.thousandBitSeparator(Number(r).toFixed(4)),validBTC:this.thousandBitSeparator(Number(o).toFixed(2)),currentTD:this.thousandBitSeparator(Number(c).toFixed(4)),currentBTC:this.thousandBitSeparator(Number(c*u).toFixed(8)),pay:this.thousandBitSeparator(Number(s).toFixed(4))}})}},{key:"fetchPlatformDetail",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments[1],n=this.state,i=n.startTime,l=n.endTime,r=n.action;f.a.httpRequest("mining/history",{PageSize:10,Page:e,Action:void 0!==a?a:r,StartTime:i,EndTime:l},function(e){e.Data&&e.Data.List?(t.setDetailData(e.Data.List,"platformList"),t.setState({oldPlatformList:e.Data.List,platformDetail:{total:e.Data.Total,page:e.Data.Page,count:e.Data.PageCount}})):t.setState({platformList:[],oldPlatformList:null,platformDetail:{total:0,page:1,count:0}})},this)}},{key:"fetchUserDetail",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments[1],n=this.state,i=n.startTime,l=n.endTime,r=n.action;f.a.httpRequest("mining/userDetail",{PageSize:10,Page:e,Action:void 0!==a?a:r,StartTime:i,EndTime:l},function(e){e.Data&&e.Data.List?(t.setDetailData(e.Data.List,"userList"),t.setState({oldUserList:e.Data.List,userDetail:{total:e.Data.Total,page:e.Data.Page,count:e.Data.PageCount}})):t.setState({userList:[],oldUserList:null,userDetail:{total:0,page:1,count:0}})},this)}},{key:"setDetailData",value:function(t,e,a){t.length&&(this.state.action?this.setDaysDetailData(t,e,a):this.setCycleDetailData(t,e,a))}},{key:"setDaysDetailData",value:function(t,e,a){var n=[],i={},l=0,r=0,o=0,s=a||this.state.tdPrice;t.forEach(function(t){var e=t.toUSDT?t.toUSDT:0,a=t.mine?t.mine:0,i=t.fee?t.fee:0;r+=a,o+=i,l+=e,n.push({cycle:t.time,output:e?this.thousandBitSeparator(Number(e).toFixed(4))+"/"+this.thousandBitSeparator(Number(a).toFixed(4)):this.thousandBitSeparator(Number(a).toFixed(4)),exchange:this.thousandBitSeparator((a*s).toFixed(8)),poundage:this.thousandBitSeparator(Number(i).toFixed(8)),distribute:""})},this),i[e]=n,this.setState(i),this.setState({tableTitle:[3,4,5,6]}),"platformList"===e?this.setState({platformCount:{countOutputTotal:this.thousandBitSeparator(Number(r).toFixed(4)),countExchangeTotal:this.thousandBitSeparator((r*s).toFixed(8))}}):this.setState({userCount:{countOutputValue:this.thousandBitSeparator(Number(l).toFixed(4)),countOutputTotal:this.thousandBitSeparator(Number(r).toFixed(4)),countExchangeTotal:this.thousandBitSeparator((r*s).toFixed(8))}})}},{key:"setCycleDetailData",value:function(t,e,a){var n=[],i={},l=0,r=0,o=0,s=0,u=a||this.state.tdPrice;t.forEach(function(t){var e=t.health,a=t.currentPeriod?t.currentPeriod:0,i=new Date(m()(t.time)).getTime()-3e5,c=m()(i).format("YYYY-MM-DD HH:mm"),d=t.mine?t.mine:0,g=d/t.health*a,h=t.fee?t.fee:0;l+=g,r+=d,o+=g*u,s+=d*u,n.push({cycle:c+"~"+t.time,output:this.thousandBitSeparator(Number(g).toFixed(4))+"/"+this.thousandBitSeparator(Number(d).toFixed(4)),exchange:this.thousandBitSeparator((g*u).toFixed(8))+"/"+this.thousandBitSeparator((d*u).toFixed(8)),poundage:this.thousandBitSeparator(Number(h).toFixed(8)),distribute:a+"/"+e})},this),i[e]=n,this.setState(i),this.setState({tableTitle:[3,4,5,6,7]}),"platformList"===e?this.setState({platformCount:{countOutputValue:this.thousandBitSeparator(Number(l).toFixed(4)),countOutputTotal:this.thousandBitSeparator(Number(r).toFixed(4)),countExchangeValue:this.thousandBitSeparator(o.toFixed(8)),countExchangeTotal:this.thousandBitSeparator(s.toFixed(8))}}):this.setState({userCount:{countOutputValue:this.thousandBitSeparator(Number(l).toFixed(4)),countOutputTotal:this.thousandBitSeparator(Number(r).toFixed(4)),countExchangeValue:this.thousandBitSeparator(o.toFixed(8)),countExchangeTotal:this.thousandBitSeparator(s.toFixed(8))}})}},{key:"componentWillUpdate",value:function(t,e){var a=JSON.stringify(this.state.tdPrice),n=JSON.stringify(e.tdPrice),i=this.state,l=i.oldUserInfo,r=i.oldPlatformList,o=i.oldUserList;a!==n&&(l&&this.setUserInfo(l,Number(n)),r&&this.setDetailData(r,"platformList",Number(n)),o&&this.setDetailData(o,"userList",Number(n)))}},{key:"thousandBitSeparator",value:function(t){var e=/(^|\s)\d+(?=\.?\d*($|\s))/g,a=/(?=(?!\b)(\d{3})+\.?\b)/g;return t&&t.toString().replace(e,function(t){return t.replace(a,",")})}},{key:"changeTab",value:function(t){t!==this.state.tab&&(t?this.fetchUserDetail():this.fetchPlatformDetail(),this.setState({tab:t}))}},{key:"startDate",value:function(t){this.setState({startDate:t});var e=m()(t).format("YYYY-MM-DD"),a=parseInt(new Date(e+" 00:00").getTime()/1e3);this.setState({startTime:a})}},{key:"endDate",value:function(t){this.setState({endDate:t});var e=m()(t).format("YYYY-MM-DD"),a=parseInt(new Date(e+" 23:59").getTime()/1e3);this.setState({endTime:a})}},{key:"selectPeriod",value:function(){this.state.endTime>=this.state.startTime&&(this.state.tab?this.fetchUserDetail():this.fetchPlatformDetail())}},{key:"platformChangePage",value:function(t){this.fetchPlatformDetail(t)}},{key:"userChangePage",value:function(t){this.fetchUserDetail(t)}},{key:"changeAction",value:function(t){this.state.action!==t&&(this.setState({action:t}),this.state.tab?this.fetchUserDetail(1,t):this.fetchPlatformDetail(1,t))}},{key:"JumpLogon",value:function(){b.a.push({pathname:"/login",query:{return_to:"/mining"}})}},{key:"render",value:function(){var t=this,e=[u.a.lang("trading.dig.1"),u.a.lang("trading.dig.2")],a=this.state,n=a.tab,i=a.startDate,l=a.endDate,r=a.platformInfo,s=a.tdPrice,d=a.userInfo,h=a.platformList,p=a.userList,f=(a.isNoData,a.isLogin),E=a.platformDetail,b=a.userDetail,y=a.platformCount,D=a.userCount,v=a.action,T=a.tableTitle;return o.a.createElement("div",{className:"okk-trade-contain"},o.a.createElement("div",{className:"trad-dig-bg"},o.a.createElement("p",null,u.a.lang("trading.dig.9")),o.a.createElement("h4",null,u.a.lang("trading.dig.10")),o.a.createElement("p",{className:"last-p-title"},o.a.createElement("a",{href:"https://support.tdex.com/hc/zh-cn/articles/360015588212-%E4%BB%80%E4%B9%88%E6%98%AF%E4%BA%A4%E6%98%93%E6%8C%96%E7%9F%BF-%E6%94%B6%E5%85%A5%E5%88%86%E7%BA%A2- ",target:"_blank"},u.a.lang("trading.dig.11")))),o.a.createElement("div",{className:"trad-dig-sum"},o.a.createElement("div",null,o.a.createElement("span",null,u.a.lang("trading.dig.12"),"TD"),o.a.createElement("p",null,r.pay,"/",r.totalTD),o.a.createElement("span",null,u.a.lang("trading.dig.27"),"BTC\uff1a",r.bonusTotal)),o.a.createElement("div",null,o.a.createElement("span",null,u.a.lang("trading.dig.28"),"TD"),o.a.createElement("p",null,r.currentTD),o.a.createElement("span",null,u.a.lang("trading.dig.29"),"BTC\uff1a",r.bonusToday)),o.a.createElement("div",null,o.a.createElement("span",null,u.a.lang("trading.dig.34"),"\uff1a",r.currentCycle,o.a.createElement("i",{className:"iconfont icon-question m-hide","data-tip":u.a.lang("trading.dig.tips")})),o.a.createElement("p",null,o.a.createElement("span",{style:{fontWeight:500,fontSize:"14px",verticalAlign:"text-bottom"}},u.a.lang("trading.dig.35"),"BTC\uff1a"),r.totalCost),o.a.createElement("span",null,u.a.lang("trading.dig.25"),"BTC\uff1a",s))),o.a.createElement("div",{className:"trad-dig-title"},o.a.createElement("h3",null,u.a.lang("trading.dig.16"))),o.a.createElement("div",null,f?o.a.createElement("div",{className:"trad-dig-sum2"},o.a.createElement("div",null,o.a.createElement("div",{className:"dig-sum-pic"},o.a.createElement("img",{src:"https://res1.tdex.com/images/mining/dig-icon1.png"})),o.a.createElement("span",null,u.a.lang("trading.dig.17"),"TD"),o.a.createElement("p",null,d.pay,"/",d.totalTD),o.a.createElement("span",null,u.a.lang("trading.dig.18"),"BTC\uff1a",d.totalBTC)),o.a.createElement("div",null,o.a.createElement("div",{className:"dig-sum-pic"},o.a.createElement("img",{src:"https://res1.tdex.com/images/mining/dig-icon3.png"})),o.a.createElement("span",null,u.a.lang("trading.dig.36"),"TD"),o.a.createElement("p",null,d.validTD),o.a.createElement("span",null,u.a.lang("trading.dig.37"),"\uff1a",d.validBTC)),o.a.createElement("div",null,o.a.createElement("div",{className:"dig-sum-pic"},o.a.createElement("img",{src:"https://res1.tdex.com/images/mining/dig-icon2.png"})),o.a.createElement("span",null,u.a.lang("trading.dig.19"),"BTC"),o.a.createElement("p",null,d.totalCost),o.a.createElement("span",null,u.a.lang("trading.dig.20"),"BTC\uff1a",d.currentCost)),o.a.createElement("div",null,o.a.createElement("div",{className:"dig-sum-pic"},o.a.createElement("img",{src:"https://res1.tdex.com/images/mining/dig-icon4.png"})),o.a.createElement("span",null,u.a.lang("trading.dig.28"),"TD"),o.a.createElement("p",null,d.currentTD),o.a.createElement("span",null,u.a.lang("trading.dig.18"),"BTC\uff1a",d.currentBTC))):o.a.createElement("div",null,o.a.createElement("div",{className:"dig-no-data",style:{paddingTop:"10px"}},o.a.createElement("img",{src:"https://res1.tdex.com/images/mining/dig-emojy.png"})),o.a.createElement("div",null,o.a.createElement("p",{className:"dig-no-data-p"},o.a.createElement("span",{style:{color:"#777"},onClick:function(){t.JumpLogon()}},u.a.lang("trading.dig.26")))))),o.a.createElement("div",{className:"trad-dig-tab"},o.a.createElement("ul",null,e.map(function(e,a){return o.a.createElement("li",{key:a,onClick:function(){return t.changeTab(a)}},o.a.createElement("span",{className:n===a?"active":""},e))})),o.a.createElement("ul",{className:"zwe-select-list"},o.a.createElement("li",{className:"date-picket-box first-li"},v?u.a.lang("trading.dig.31"):u.a.lang("trading.dig.30"),o.a.createElement("div",{className:"first-select"},o.a.createElement("p",{onClick:function(){t.changeAction(0)}},u.a.lang("trading.dig.30")),o.a.createElement("p",{onClick:function(){t.changeAction(1)}},u.a.lang("trading.dig.31")))),o.a.createElement("li",{className:"date-picket-box"},o.a.createElement("i",{className:"iconfont icon-date pdl-5 pos-a"}),o.a.createElement(g.a,{dateFormat:"YYYY-MM-DD",selected:i,locale:"zh-gb",minDate:m()().subtract(1,"year"),maxDate:m()(),onChange:this.startDate.bind(this)})),o.a.createElement("li",{className:"date-picket-box",style:{marginLeft:"5px"}},o.a.createElement("i",{className:"iconfont icon-date pdl-5 pos-a"}),o.a.createElement(g.a,{dateFormat:"YYYY-MM-DD",locale:"zh-gb",selected:l,minDate:m()().subtract(1,"year"),maxDate:m()(),onChange:this.endDate.bind(this)})),o.a.createElement("li",null,o.a.createElement("button",{onClick:function(){return t.selectPeriod()},className:"btn with-btn logBtn ml-10 date-picket-box-btn",type:"submit"},u.a.lang("Asset.111"))))),o.a.createElement("div",{className:"zwb-platform-detail",style:{display:n?"none":"block"}},h.length?o.a.createElement("div",null,o.a.createElement("div",{className:"dig-tab-list",style:{minHeight:"755px"}},o.a.createElement("table",{className:"deform"},o.a.createElement("thead",null,o.a.createElement("tr",null,T.map(function(t,e){return o.a.createElement("td",{key:e},u.a.lang("trading.dig."+t))}))),o.a.createElement("tbody",null,h.map(function(t,e){return o.a.createElement("tr",{key:e},o.a.createElement("td",null,t.cycle),o.a.createElement("td",null,t.output),o.a.createElement("td",null,t.exchange),o.a.createElement("td",null,t.poundage),v?null:o.a.createElement("td",null,t.distribute))}),o.a.createElement("tr",{className:"tab-list-add",style:{visibility:h.length?"visible":"hidden",borderBottom:0}},o.a.createElement("td",null,u.a.lang("trading.dig.8")),o.a.createElement("td",null,y.countOutputValue?y.countOutputValue+"/":"",y.countOutputTotal),o.a.createElement("td",null,y.countExchangeValue?y.countExchangeValue+"/":"",y.countExchangeTotal),o.a.createElement("td",{style:{borderBottom:0}}),v?null:o.a.createElement("td",{style:{borderBottom:0}}))))),o.a.createElement(c.a,{className:"trad-dig-Pg",data:{PageSize:10,Total:E.total,Page:E.page,PageCount:E.count},onChange:this.platformChangePage.bind(this)})):o.a.createElement("div",{className:"dig-tab-list"},o.a.createElement("table",{className:"deform"},o.a.createElement("thead",null,o.a.createElement("tr",null,T.map(function(t,e){return o.a.createElement("td",{key:e},u.a.lang("trading.dig."+t))})))),o.a.createElement("div",{className:"dig-no-data"},o.a.createElement("img",{src:"https://res1.tdex.com/images/mining/dig-emojy.png"})),o.a.createElement("div",null,o.a.createElement("p",{className:"dig-no-data-p"},u.a.lang("bank.1_27"))))),o.a.createElement("div",{className:"zwb-user-detail",style:{display:n?"block":"none"}},f?o.a.createElement("div",null,p.length?o.a.createElement("div",null,o.a.createElement("div",{className:"dig-tab-list",style:{minHeight:"755px"}},o.a.createElement("table",{className:"deform"},o.a.createElement("thead",null,o.a.createElement("tr",null,T.map(function(t,e){return o.a.createElement("td",{key:e},u.a.lang("trading.dig."+t))}))),o.a.createElement("tbody",null,p.map(function(t,e){return o.a.createElement("tr",{key:e},o.a.createElement("td",null,t.cycle),o.a.createElement("td",null,t.output),o.a.createElement("td",null,t.exchange),o.a.createElement("td",null,t.poundage),v?null:o.a.createElement("td",null,t.distribute))}),o.a.createElement("tr",{className:"tab-list-add",style:{visibility:p.length?"visible":"hidden",borderBottom:0}},o.a.createElement("td",null,u.a.lang("trading.dig.8")),o.a.createElement("td",null,D.countOutputValue?D.countOutputValue+"/":"",D.countOutputTotal),o.a.createElement("td",null,D.countExchangeValue?D.countExchangeValue+"/":"",D.countExchangeTotal),o.a.createElement("td",{style:{borderBottom:0}}),v?null:o.a.createElement("td",{style:{borderBottom:0}}))))),o.a.createElement(c.a,{className:"trad-dig-Pg",data:{PageSize:10,Total:b.total,Page:b.page,PageCount:b.count},onChange:this.userChangePage.bind(this)})):o.a.createElement("div",{className:"dig-tab-list"},o.a.createElement("table",{className:"deform"},o.a.createElement("thead",null,o.a.createElement("tr",null,T.map(function(t,e){return o.a.createElement("td",{key:e},u.a.lang("trading.dig."+t))})))),o.a.createElement("div",{className:"dig-no-data"},o.a.createElement("img",{src:"https://res1.tdex.com/images/mining/dig-emojy.png"})),o.a.createElement("div",null,o.a.createElement("p",{className:"dig-no-data-p"},u.a.lang("bank.1_27"))))):o.a.createElement("div",{className:"dig-tab-list"},o.a.createElement("div",{className:"dig-no-data"},o.a.createElement("img",{src:"https://res1.tdex.com/images/mining/dig-emojy.png"})),o.a.createElement("div",null,o.a.createElement("p",{className:"dig-no-data-p"},o.a.createElement("span",{style:{color:"#777"},onClick:function(){t.JumpLogon()}},u.a.lang("trading.dig.26")))))))}}]),e}(s.a);e.default=B}});