webpackJsonp([39],{118:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),function(e){function n(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function i(e,a){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!==typeof a&&"function"!==typeof a?e:a}function l(e,a){if("function"!==typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}var s=t(0),r=t.n(s),c=t(149),o=t.n(c),p=t(2),u=t(24),m=t(9),d=t(26),h=t(79),f=t(18),g=t(7),v=t(147),b=t(5),E=t(241),y=t.n(E),N=function(){function e(e,a){for(var t=0;t<a.length;t++){var n=a[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(a,t,n){return t&&e(a.prototype,t),n&&e(a,n),a}}(),S=e,k=function(e){function a(e){n(this,a);var t=i(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.state={name:"",list:null},t}return l(a,e),N(a,[{key:"componentWillMount",value:function(){this.loadList()}},{key:"loadList",value:function(){var e=this;m.a.httpRequest("user/api","",function(a){0==a.Status&&e.setState({list:a.Data.List||[]})},this)}},{key:"onCreate",value:function(e){var a=this;e.preventDefault(),e.stopPropagation();var t=this.state.name;if(!t)return S("#apiName").focus(),void Object(b.g)(p.a.lang("form.error.empty"),!0);if(!/^[0-9A-Z]{4,20}$/gi.test(t))return S("#apiName").focus(),void Object(b.g)(p.a.lang("api.error.name"),!0);var n=f.a.getUserInfo();n.GgAuth||n.Mobile?d.a.open(r.a.createElement(h.default,{path:"with",verify:"normal",onChange:function(e){if("string"==typeof e)return void d.a.close();e.Name=t,m.a.httpRequest("user/api/create",e,function(e){if(0==e.Status){d.a.close();var a={pathname:"/apiEmail"};e.Data&&e.Data.ActivateUrl&&(a.query={ActivateUrl:e.Data.ActivateUrl}),g.a.push(a)}},a,"put")},datafor:"other"}),"simple_lang"):Object(b.g)(p.a.lang("Withdrawals.119"),!0)}},{key:"onChangeName",value:function(e){e.stopPropagation();var a=e.target.value;a=a.replace(/[^0-9A-Z]*/gi,""),this.setState({name:a})}},{key:"delAll",value:function(){var e=this;d.a.open(r.a.createElement(v.a,{title:"",content:p.a.lang("api.delAll.confirm"),callback:function(){var a=[];e.state.list.forEach(function(e){a.push(e.Key)}),m.a.httpRequest("user/api/delete",{List:a},function(a){0==a.Status&&e.loadList()},e,"delete")}}),"alert_panel")}},{key:"onItemSubmit",value:function(){this.loadList()}},{key:"render",value:function(){var e=this,a=this.state,t=a.list,n=a.name,i=t&&!!t[0];return r.a.createElement("div",{className:"okk-trade-contain pos-r"},t&&!i&&r.a.createElement("div",{className:"page-api"},r.a.createElement("div",{className:"api"},r.a.createElement("img",{src:y.a})),r.a.createElement("p",{className:"fs16 tc pd-tb-35"},p.a.lang("api.createstart")),r.a.createElement("label",{className:"addApi"},r.a.createElement("input",{type:"text",placeholder:p.a.lang("api.inputTip"),maxLength:20,value:n,onChange:this.onChangeName.bind(this)}),r.a.createElement("input",{type:"button",value:p.a.lang("api.createBtn"),className:"btn btn-light-blue",onClick:this.onCreate.bind(this)}))),i&&r.a.createElement("div",{className:"apiLists-hd"},r.a.createElement("h3",null,"API"),r.a.createElement("p",{className:""},p.a.lang("api.opentxtip")),r.a.createElement("p",null),r.a.createElement("div",null,r.a.createElement("label",{className:"addApi"},r.a.createElement("input",{type:"text",placeholder:p.a.lang("api.inputTip"),value:n,maxLength:20,onChange:this.onChangeName.bind(this)}),r.a.createElement("input",{type:"button",value:p.a.lang("api.createBtn"),className:"btn btn-light-blue",onClick:this.onCreate.bind(this)})))),i&&r.a.createElement("div",{className:"contain pdb-30"},r.a.createElement("div",{className:"deleteall"},r.a.createElement("a",{onClick:this.delAll.bind(this),href:"javascript:;"},p.a.lang("api.delAll"))),t&&t.map(function(a,t){return r.a.createElement(C,{data:a,key:t,guid:t,uInfo:e.props.uInfo,onSubmit:e.onItemSubmit.bind(e)})})))}}]),a}(u.a);a.default=k;var C=function(e){function a(e){n(this,a);var t=i(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));t.perms=[1,2,4],t.ipLimits=[2,1];var l=t.props.data;return t.state={isEdit:!1,ipStatus:l.CIDR?2:1,ips:l.CIDR,perm:l.Permissions},t}return l(a,e),N(a,[{key:"componentDidMount",value:function(){o.a.rebuild()}},{key:"del",value:function(){var e=this,a=this.props.data.Key;d.a.open(r.a.createElement(v.a,{title:"",content:p.a.lang("api.del.confirm",a),callback:function(){m.a.httpRequest("user/api/delete",{List:[a]},function(a){0==a.Status&&e.props.onSubmit&&e.props.onSubmit()},e,"delete")}}),"alert_panel")}},{key:"editOrSave",value:function(){var e=this;if(this.state.isEdit){var a=this.state.ips;if(2==this.state.ipStatus&&!/^(?:(?:^|,)(?:[0-9]|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])(?:\.(?:[0-9]|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])){3})+$/.test(a))return void Object(b.g)(p.a.lang("api.error.ips"),!0);d.a.open(r.a.createElement(h.default,{path:"with",verify:"normal",onChange:function(a){if("string"==typeof a)return void d.a.close();Object.assign(a,{Key:e.props.data.Key,CIDR:2==e.state.ipStatus?e.state.ips:"",Permissions:e.state.perm,Enabled:e.props.data.Enabled}),m.a.httpRequest("user/api/modify",a,function(a){0==a.Status&&(d.a.close(),e.setState({isEdit:!1}),e.props.onSubmit&&e.props.onSubmit())},e,"put")},datafor:"other"}),"simple_lang")}else this.setState({isEdit:!0})}},{key:"onChangeIpStatus",value:function(e){e.stopPropagation(),this.setState({ipStatus:Number(e.target.value)})}},{key:"onChangePerm",value:function(e){e.stopPropagation();var a=this.state.perm,t=Number(e.target.value);e.target.checked?(a&t)!=t&&this.setState({perm:a+t}):(a&t)==t&&this.setState({perm:a-t})}},{key:"onChangeIps",value:function(e){e.stopPropagation();var a=e.target.value;a=a.replace(/[^0-9\.,]/g,""),this.setState({ips:a})}},{key:"render",value:function(){var e=this,a=this.props,t=a.data,n=a.guid,i=a.uInfo,l=this.state,s=l.isEdit,c=l.ipStatus,o=l.ips,u=l.perm;return r.a.createElement("div",{className:"panel"},r.a.createElement("div",{className:"panel-title f-cb "},t.Name,r.a.createElement("span",{className:"btn fr",onClick:this.del.bind(this)},p.a.lang("api.del")),r.a.createElement("span",{className:s?"btn fr btn-b":"btn fr",style:{marginRight:"5px"},onClick:this.editOrSave.bind(this)},p.a.lang(s?"api.save":"api.edit"))),r.a.createElement("div",{className:"pd-15"},r.a.createElement("div",{className:"keySecret f-oh"},r.a.createElement("div",{className:"fl ewm"},r.a.createElement("img",{src:"https://res1.tdex.com/images/icons/hideEwm.jpg"})),r.a.createElement("div",{className:"fl"},r.a.createElement("ul",{className:"apiParams"},r.a.createElement("li",null,r.a.createElement("label",{className:""},"API Key: "),r.a.createElement("div",{className:""},t.Key)),r.a.createElement("li",null,r.a.createElement("label",{className:""},"Secret Key: "),r.a.createElement("i",{className:"iconfont icon-warn withdrawTip","data-tip":p.a.lang("api.secret.tip")}),r.a.createElement("div",null,r.a.createElement("span",null,t.Secret))),r.a.createElement("li",null,r.a.createElement("label",{className:""},p.a.lang("api.perm")),r.a.createElement("div",{className:"rules"},this.perms.map(function(a,t){return r.a.createElement("label",{className:"checkbox",key:t},r.a.createElement("input",{type:"checkbox",name:"perm"+n,value:a,checked:(u&a)==a,disabled:!s,onChange:e.onChangePerm.bind(e)}),r.a.createElement("span",null),p.a.lang("api.perm"+a))}),r.a.createElement("i",{className:"iconfont icon-warn withdrawTip","data-tip":p.a.lang("api.tixian.tip")})))))),r.a.createElement("div",{className:"ipLimit f-oh mt-15"},r.a.createElement("div",{className:"fl label "},p.a.lang("api.ipLimit")),r.a.createElement("div",{className:"fl"},this.ipLimits.map(function(a,t){return r.a.createElement("label",{className:"",key:t},r.a.createElement("input",{name:"ipStatus"+n,type:"radio",value:a,disabled:!s,checked:a==c,onChange:e.onChangeIpStatus.bind(e)}),p.a.lang("api.ipStatus"+a))}),1==c&&r.a.createElement("div",null,r.a.createElement("p",{className:"info "},p.a.lang("api.ipTip"))),2==c&&r.a.createElement("div",null,r.a.createElement("div",{className:"curIp ng-binding"},p.a.lang("api.loginIp",i.LastLoginIP)),r.a.createElement("div",{className:"trusted"},r.a.createElement("label",{className:"ng-binding"},p.a.lang("api.safeIp")),r.a.createElement("div",{className:"trusted-input"},r.a.createElement("label",null,r.a.createElement("input",{className:"ng-pristine ng-valid",type:"text",name:"tradeIp",value:o,onChange:this.onChangeIps.bind(this)})),r.a.createElement("p",{className:"ng-binding"},p.a.lang("api.safeIp.tip")))))))))}}]),a}(u.a)}.call(a,t(13))}});